---
title: "HDI impact on suicides"
autor: "Fernando Gomes"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
suicides <- read_csv("../data/master.csv")
library(tidyverse)
library(tidymodels)
library(openintro)
library(patchwork)
```

```{r suicide}
suicides_clean <- suicides %>% 
  rename(hdi = 'HDI for year',
         suicides_per_100k_pop = 'suicides/100k pop',
         country_year = 'country-year',
         gdp ='gdp_for_year ($)',
         gdp_per_capita = 'gdp_per_capita ($)') 
```

```{r suicide-average}
suicide_rates_hdi <- suicides_clean %>%
  filter(!is.na(hdi)) %>%
  group_by(country) %>%
  summarise(suicide_rates = mean(suicides_per_100k_pop), mean_hdi = mean(hdi)) %>% 
  arrange(desc(suicide_rates))
  
suicide_rates_hdi
```

```{r}
suicide_rates_hdi %>%
  ggplot(aes(x = mean_hdi, y = suicide_rates)) + 
  geom_point() +
  geom_smooth(method = "lm", color = "red") +
  labs(title = "Rate of Suicides Against HDI",
       x = "Human Development Index",
       y = "Suicides per 100k Population")
``` 

